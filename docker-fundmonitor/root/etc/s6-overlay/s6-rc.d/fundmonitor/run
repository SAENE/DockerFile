#!/usr/bin/with-contenv bash
# ==============================================================================
# FundMonitor 内网启动脚本
# 使用 with-contenv 加载环境变量，s6-overlay 管理进程
# ==============================================================================

cd /app || exit 1

# 默认 UID/GID
: "${PUID:=1000}"
: "${PGID:=1000}"

echo "以 UID:${PUID} GID:${PGID} 启动 FundMonitor (内网模式)..."

# 使用 Gunicorn 启动 Flask 应用，仅监听内网
exec s6-setuidgid "${PUID}:${PGID}" \
    gunicorn -w 4 -b 0.0.0.0:5000 app:app
